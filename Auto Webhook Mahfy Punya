-- Roblox Auto E Press Macro with UI
-- Paste this script into your executor and run

local VirtualInputManager = game:GetService("VirtualInputManager")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- Variables
local player = Players.LocalPlayer
local macroRunning = false
local macroThread = nil

-- Function to simulate key press
local function pressKey(key, duration)
    if not macroRunning then return end
    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode[key], false, game)
    wait(duration or 0.03)
    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode[key], false, game)
end

-- Function to wait (delay in milliseconds converted to seconds)
local function delay(ms)
    if not macroRunning then return end
    wait(ms / 1000)
end

-- Macro sequence function
local function runMacro()
    while macroRunning do
        delay(460)
        pressKey("E") delay(502)
        pressKey("E") delay(47)
        pressKey("E") delay(37)
        pressKey("E") delay(24)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(34)
        pressKey("E") delay(28)
        pressKey("E") delay(46)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(46)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(30)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(30)
        pressKey("E") delay(47)
        pressKey("E") delay(31)
        pressKey("E") delay(30)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(46)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(30)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(46)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(48)
        pressKey("E") delay(30)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        pressKey("E") delay(32)
        pressKey("E") delay(30)
        pressKey("E") delay(31)
        pressKey("E") delay(31)
        
        delay(460)
        delay(2460)
        delay(460)
    end
end

-- Create UI
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local ToggleButton = Instance.new("TextButton")
local StatusLabel = Instance.new("TextLabel")
local CloseButton = Instance.new("TextButton")
local UICorner1 = Instance.new("UICorner")
local UICorner2 = Instance.new("UICorner")
local UICorner3 = Instance.new("UICorner")

-- Properties
ScreenGui.Name = "GachaMacroUI"
ScreenGui.Parent = player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -100)
MainFrame.Size = UDim2.new(0, 300, 0, 200)
MainFrame.Active = true
MainFrame.Draggable = true

UICorner1.CornerRadius = UDim.new(0, 10)
UICorner1.Parent = MainFrame

Title.Name = "Title"
Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
Title.BorderSizePixel = 0
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Font = Enum.Font.GothamBold
Title.Text = "ðŸŽ® Gacha Macro"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 10)
TitleCorner.Parent = Title

ToggleButton.Name = "ToggleButton"
ToggleButton.Parent = MainFrame
ToggleButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
ToggleButton.BorderSizePixel = 0
ToggleButton.Position = UDim2.new(0.1, 0, 0.35, 0)
ToggleButton.Size = UDim2.new(0.8, 0, 0, 45)
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.Text = "START MACRO"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.TextSize = 16

UICorner2.CornerRadius = UDim.new(0, 8)
UICorner2.Parent = ToggleButton

StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = MainFrame
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0, 0, 0.65, 0)
StatusLabel.Size = UDim2.new(1, 0, 0, 30)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.Text = "Status: Stopped â­•"
StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
StatusLabel.TextSize = 14

CloseButton.Name = "CloseButton"
CloseButton.Parent = MainFrame
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(0.85, 0, 0.05, 0)
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 16

UICorner3.CornerRadius = UDim.new(0, 15)
UICorner3.Parent = CloseButton

-- Toggle Button Function
ToggleButton.MouseButton1Click:Connect(function()
    macroRunning = not macroRunning
    
    if macroRunning then
        ToggleButton.Text = "STOP MACRO"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 220, 50)
        StatusLabel.Text = "Status: Running âœ…"
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        
        -- Start macro in a new thread
        macroThread = coroutine.create(runMacro)
        coroutine.resume(macroThread)
        
        print("Gacha Macro started!")
    else
        ToggleButton.Text = "START MACRO"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
        StatusLabel.Text = "Status: Stopped â­•"
        StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
        
        print("Gacha Macro stopped!")
    end
end)

-- Close Button Function
CloseButton.MouseButton1Click:Connect(function()
    macroRunning = false
    ScreenGui:Destroy()
    print("Gacha Macro UI closed")
end)

-- Add glow effect on hover
ToggleButton.MouseEnter:Connect(function()
    ToggleButton.TextSize = 17
end)

ToggleButton.MouseLeave:Connect(function()
    ToggleButton.TextSize = 16
end)

CloseButton.MouseEnter:Connect(function()
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
end)

CloseButton.MouseLeave:Connect(function()
    CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
end)

print("Gacha Macro UI loaded successfully!")
print("Click START MACRO to begin")

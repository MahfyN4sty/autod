-- Roblox Auto E Hold Macro with UI
-- Paste this script into your executor and run

local VirtualInputManager = game:GetService("VirtualInputManager")
local Players = game:GetService("Players")

-- Variables
local player = Players.LocalPlayer
local macroRunning = false

-- Function to hold key
local function holdKey(key, duration)
    if not macroRunning then return end
    
    -- Press and hold the key
    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode[key], false, game)
    wait(duration)
    
    -- Release the key
    if macroRunning then
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode[key], false, game)
    end
end

-- Macro sequence function
local function runMacro()
    while macroRunning do
        print("Holding E for 3 seconds...")
        holdKey("E", 3) -- Hold E for 3 seconds
        
        if not macroRunning then break end
        
        print("Waiting 2 seconds...")
        wait(2) -- Wait 2 seconds
    end
end

-- Create UI
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local ToggleButton = Instance.new("TextButton")
local StatusLabel = Instance.new("TextLabel")
local InfoLabel = Instance.new("TextLabel")
local CloseButton = Instance.new("TextButton")

-- Properties
ScreenGui.Name = "GachaMacroUI"
ScreenGui.Parent = player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -120)
MainFrame.Size = UDim2.new(0, 300, 0, 240)
MainFrame.Active = true
MainFrame.Draggable = true

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 10)
MainCorner.Parent = MainFrame

Title.Name = "Title"
Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
Title.BorderSizePixel = 0
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Font = Enum.Font.GothamBold
Title.Text = "ðŸŽ® Auto E Hold Macro"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 10)
TitleCorner.Parent = Title

InfoLabel.Name = "InfoLabel"
InfoLabel.Parent = MainFrame
InfoLabel.BackgroundTransparency = 1
InfoLabel.Position = UDim2.new(0, 0, 0.2, 0)
InfoLabel.Size = UDim2.new(1, 0, 0, 40)
InfoLabel.Font = Enum.Font.Gotham
InfoLabel.Text = "Hold: 3s | Delay: 2s"
InfoLabel.TextColor3 = Color3.fromRGB(150, 200, 255)
InfoLabel.TextSize = 13

ToggleButton.Name = "ToggleButton"
ToggleButton.Parent = MainFrame
ToggleButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
ToggleButton.BorderSizePixel = 0
ToggleButton.Position = UDim2.new(0.1, 0, 0.42, 0)
ToggleButton.Size = UDim2.new(0.8, 0, 0, 50)
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.Text = "START MACRO"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.TextSize = 16

local ButtonCorner = Instance.new("UICorner")
ButtonCorner.CornerRadius = UDim.new(0, 8)
ButtonCorner.Parent = ToggleButton

StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = MainFrame
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0, 0, 0.73, 0)
StatusLabel.Size = UDim2.new(1, 0, 0, 30)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.Text = "Status: Stopped â­•"
StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
StatusLabel.TextSize = 14

CloseButton.Name = "CloseButton"
CloseButton.Parent = MainFrame
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(0.85, 0, 0.05, 0)
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 16

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 15)
CloseCorner.Parent = CloseButton

-- Toggle Button Function
ToggleButton.MouseButton1Click:Connect(function()
    macroRunning = not macroRunning
    
    if macroRunning then
        ToggleButton.Text = "STOP MACRO"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 220, 50)
        StatusLabel.Text = "Status: Running âœ…"
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        
        -- Start macro in a new thread
        task.spawn(runMacro)
        
        print("Auto Hold Macro started!")
        print("Hold E: 3 seconds | Delay: 2 seconds")
    else
        ToggleButton.Text = "START MACRO"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
        StatusLabel.Text = "Status: Stopped â­•"
        StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
        
        -- Release key if it's being held
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
        
        print("Auto Hold Macro stopped!")
    end
end)

-- Close Button Function
CloseButton.MouseButton1Click:Connect(function()
    macroRunning = false
    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
    ScreenGui:Destroy()
    print("Auto Hold Macro UI closed")
end)

-- Hover effects
ToggleButton.MouseEnter:Connect(function()
    ToggleButton.TextSize = 17
end)

ToggleButton.MouseLeave:Connect(function()
    ToggleButton.TextSize = 16
end)

CloseButton.MouseEnter:Connect(function()
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
end)

CloseButton.MouseLeave:Connect(function()
    CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
end)

print("===================================")
print("Auto E Hold Macro Loaded!")
print("Hold Duration: 3 seconds")
print("Delay: 2 seconds")
print("Click START to begin")
print("===================================")
